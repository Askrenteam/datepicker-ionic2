"use strict";var __decorate=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},core_1=require("@angular/core"),datepicker_component_1=require("./datepicker.component"),DatePicker=function(){function e(e){this.modalCtrl=e}return e.prototype.openModal=function(){this.modalCtrl.create(datepicker_component_1.DatePickerComponent,{date:this.date,min:this.min,max:this.min,callback:this.callback})},__decorate([core_1.Input("date")],e.prototype,"date"),__decorate([core_1.Input("min")],e.prototype,"min"),__decorate([core_1.Input("max")],e.prototype,"max"),__decorate([core_1.Input("callback")],e.prototype,"callback"),e=__decorate([core_1.Directive({selector:"ionDatePicker",host:{"(click)":"openModal()"}})],e)}();exports.DatePicker=DatePicker;var __decorate=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},core_1=require("@angular/core"),platform_browser_1=require("@angular/platform-browser"),datepicker_component_1=require("./datepicker.component"),nls_1=require("./nls"),datepicker_service_1=require("./datepicker.service"),app_component_1=require("./app.component"),AppModule=function(){function e(){}return e=__decorate([core_1.NgModule({imports:[platform_browser_1.BrowserModule],declarations:[datepicker_component_1.DatePickerComponent,nls_1.nls,datepicker_service_1.DateService],bootstrap:[app_component_1.DatePicker]})],e)}();exports.AppModule=AppModule;var __decorate=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},core_1=require("@angular/core"),DatePickerComponent=function(){function e(e,t){this.DatepickerService=e,this.type="date",this.today=new Date,this.date=t.get("date"),this.min=t.get("min"),this.max=t.get("max"),this.callback=t.get("callback")}return e.prototype.initialize=function(){this.selectedDate=Object.assign({},this.date||new Date),this.tempDate=Object.assign({},this.selectedDate),this.createDateList(this.selectedDate)},e.prototype.getDaysOfWeek=function(){return this.weekdays||(this.weekdays=this.DatepickerService.getDaysOfWeek()),this.weekdays},e.prototype.getMonths=function(){return this.months||(this.months=this.DatepickerService.getMonths()),this.months},Object.defineProperty(e.prototype,"years",{get:function(){return this.DatepickerService.getYears()},enumerable:!0,configurable:!0}),e.prototype.createDateList=function(e){this.dateList=this.DatepickerService.createDateList(e),this.cols=new Array(7),this.rows=new Array(+(this.dateList.length/this.cols.length)+1)},e.prototype.getDate=function(e,t){return this.dateList[7*e+t]},e.prototype.isDefined=function(e){return void 0!==e},e.prototype.isDisabled=function(e){return!e||(!!(this.min&&(this.min.setHours(0,0,0,0),e<this.min))||!!(this.max&&(this.max.setHours(0,0,0,0),e>this.max)))},e.prototype.isActualDate=function(e){return!!e&&(e.getDate()===this.today.getDate()&&e.getMonth()===this.today.getMonth()&&e.getFullYear()===this.today.getFullYear())},e.prototype.isActualMonth=function(e){return e===this.today.getMonth()},e.prototype.isActualYear=function(e){return e===this.today.getFullYear()},e.prototype.isSelectedDate=function(e){return!!e&&(e.getDate()===this.selectedDate.getDate()&&e.getMonth()===this.selectedDate.getMonth()&&e.getFullYear()===this.selectedDate.getFullYear())},e.prototype.isSelectedMonth=function(e){return e===this.tempDate.getMonth()},e.prototype.isSelectedYear=function(e){return e===this.tempDate.getFullYear()},e.prototype.changeType=function(e){this.type=e},e.prototype.showType=function(e){return this.type===e},e.prototype.selectDate=function(e){this.isDisabled(e)||(this.selectedDate=Object.assign({},e),this.selectedDate.setHours(0,0,0,0),this.tempDate=Object.assign({},this.selectedDate))},e.prototype.selectMonth=function(e){this.tempDate=Object.assign({},this.tempDate),this.tempDate.setMonth(e),this.tempDate.getMonth()!==e&&this.tempDate.setDate(0),this.selectMonthOrYear()},e.prototype.selectYear=function(e){this.tempDate=Object.assign({},this.tempDate),this.tempDate.setFullYear(e),this.selectMonthOrYear()},e.prototype.getSelectedWeekday=function(){return this.weekdays||this.getDaysOfWeek(),this.weekdays[this.selectedDate.getDay()]},e.prototype.getSelectedMonth=function(){return this.months||this.getMonths(),this.months[this.selectedDate.getMonth()]},e.prototype.getTempMonth=function(){return this.months||this.getMonths(),this.months[this.tempDate.getMonth()]},e.prototype.onCancel=function(e){this.selectedDate=Object.assign({},this.date||new Date),this.callback(void 0)},e.prototype.onDone=function(e){this.date=Object.assign({},this.selectedDate),this.callback(this.date)},e.prototype.selectMonthOrYear=function(){this.changeType("date"),this.createDateList(this.tempDate),this.isDisabled(this.tempDate)||(this.selectedDate=this.tempDate)},e=__decorate([core_1.Component({templateUrl:"template.html",selector:"ionDatepicker"})],e)}();exports.DatePickerComponent=DatePickerComponent;var __decorate=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},core_1=require("@angular/core"),DateService=function(){function e(e){this.DatepickerNls=e,this.locale=(window.navigator.userLanguage||window.navigator.language).toLowerCase()}return e.prototype.getDaysOfWeek=function(){return this.DatepickerNls.getWeekdays(this.locale)},e.prototype.getMonths=function(){return this.DatepickerNls.getMonths(this.locale)},e.prototype.getYears=function(){for(var e=[],t=1900;t<2101;t++)e.push(t);return e},e.prototype.createDateList=function(e){for(var t=new Date(e.getFullYear(),e.getMonth(),1).getDate(),r=new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),o=[],n=t;n<=r;n++)o.push(new Date(e.getFullYear(),e.getMonth(),n));t=o[0].getDay();for(var a=0;a<t;a++)o.unshift(void 0);return o},e=__decorate([core_1.Injectable()],e)}();exports.DateService=DateService;var __decorate=this&&this.__decorate||function(e,t,r,o){var n,a=arguments.length,i=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(i=(a<3?n(i):a>3?n(t,r,i):n(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i},core_1=require("@angular/core"),_nls={"en-us":{weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},"pt-br":{weekdays:["Domingo","Segunda-Feira","Terça-Feira","Quarta-Feira","Quinta-Feira","Sexta-Feira","Sábado"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"]}},nls=function(){function e(){}return e.prototype.getWeekdays=function(e){return this.getNls(e).weekdays},e.prototype.getMonths=function(e){return this.getNls(e).months},e.prototype.getNls=function(t){return e[t]||e["en-us"]},e=__decorate([core_1.Injectable()],e)}();exports.nls=nls;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9qcy1saWJyYXJ5LmpzIiwiYXBwLmNvbXBvbmVudC50cyIsImFwcC5tb2R1bGUudHMiLCJkYXRlcGlja2VyLmNvbXBvbmVudC50cyIsImRhdGVwaWNrZXIuc2VydmljZS50cyIsIm5scy50cyJdLCJuYW1lcyI6WyJfX2RlY29yYXRlIiwidGhpcyIsImRlY29yYXRvcnMiLCJ0YXJnZXQiLCJrZXkiLCJkZXNjIiwiZCIsImMiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJyIiwiT2JqZWN0IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiUmVmbGVjdCIsImRlY29yYXRlIiwiaSIsImRlZmluZVByb3BlcnR5IiwiY29yZV8xIiwicmVxdWlyZSIsImRhdGVwaWNrZXJfY29tcG9uZW50XzEiLCJEYXRlUGlja2VyIiwibW9kYWxDdHJsIiwicHJvdG90eXBlIiwib3Blbk1vZGFsIiwiY3JlYXRlIiwiRGF0ZVBpY2tlckNvbXBvbmVudCIsImRhdGUiLCJtaW4iLCJtYXgiLCJjYWxsYmFjayIsIklucHV0IiwiRGlyZWN0aXZlIiwic2VsZWN0b3IiLCJob3N0IiwiKGNsaWNrKSIsImV4cG9ydHMiLCJwbGF0Zm9ybV9icm93c2VyXzEiLCJubHNfMSIsImRhdGVwaWNrZXJfc2VydmljZV8xIiwiYXBwX2NvbXBvbmVudF8xIiwiQXBwTW9kdWxlIiwiTmdNb2R1bGUiLCJpbXBvcnRzIiwiQnJvd3Nlck1vZHVsZSIsImRlY2xhcmF0aW9ucyIsIm5scyIsIkRhdGVTZXJ2aWNlIiwiYm9vdHN0cmFwIiwiRGF0ZXBpY2tlclNlcnZpY2UiLCJuYXZQYXJhbXMiLCJ0eXBlIiwidG9kYXkiLCJEYXRlIiwiZ2V0IiwiaW5pdGlhbGl6ZSIsInNlbGVjdGVkRGF0ZSIsImFzc2lnbiIsInRlbXBEYXRlIiwiY3JlYXRlRGF0ZUxpc3QiLCJnZXREYXlzT2ZXZWVrIiwid2Vla2RheXMiLCJnZXRNb250aHMiLCJtb250aHMiLCJnZXRZZWFycyIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJkYXRlTGlzdCIsImNvbHMiLCJBcnJheSIsInJvd3MiLCJnZXREYXRlIiwicm93IiwiY29sIiwiaXNEZWZpbmVkIiwidW5kZWZpbmVkIiwiaXNEaXNhYmxlZCIsInNldEhvdXJzIiwiaXNBY3R1YWxEYXRlIiwiZ2V0TW9udGgiLCJnZXRGdWxsWWVhciIsImlzQWN0dWFsTW9udGgiLCJtb250aCIsImlzQWN0dWFsWWVhciIsInllYXIiLCJpc1NlbGVjdGVkRGF0ZSIsImlzU2VsZWN0ZWRNb250aCIsImlzU2VsZWN0ZWRZZWFyIiwiY2hhbmdlVHlwZSIsInZhbCIsInNob3dUeXBlIiwic2VsZWN0RGF0ZSIsInNlbGVjdE1vbnRoIiwic2V0TW9udGgiLCJzZXREYXRlIiwic2VsZWN0TW9udGhPclllYXIiLCJzZWxlY3RZZWFyIiwic2V0RnVsbFllYXIiLCJnZXRTZWxlY3RlZFdlZWtkYXkiLCJnZXREYXkiLCJnZXRTZWxlY3RlZE1vbnRoIiwiZ2V0VGVtcE1vbnRoIiwib25DYW5jZWwiLCJlIiwib25Eb25lIiwiQ29tcG9uZW50IiwidGVtcGxhdGVVcmwiLCJEYXRlcGlja2VyTmxzIiwibG9jYWxlIiwid2luZG93IiwibmF2aWdhdG9yIiwibGFuZ3VhZ2UiLCJ0b0xvd2VyQ2FzZSIsImdldFdlZWtkYXlzIiwieWVhcnMiLCJwdXNoIiwiY3VycmVudERhdGUiLCJmaXJzdERheSIsImxhc3REYXkiLCJqIiwidW5zaGlmdCIsIkluamVjdGFibGUiLCJfbmxzIiwiZW4tdXMiLCJwdC1iciIsImdldE5scyJdLCJtYXBwaW5ncyI6IkFBQUEsWUFDQSxJQUFJQSxZQUFjQyxNQUFRQSxLQUFLRCxZQUFlLFNBQVVFLEVBQVlDLEVBQVFDLEVBQUtDLEdBQzdFLEdBQTJIQyxHQUF2SEMsRUFBSUMsVUFBVUMsT0FBUUMsRUFBSUgsRUFBSSxFQUFJSixFQUFrQixPQUFURSxFQUFnQkEsRUFBT00sT0FBT0MseUJBQXlCVCxFQUFRQyxHQUFPQyxDQUNySCxJQUF1QixnQkFBWlEsVUFBb0Qsa0JBQXJCQSxTQUFRQyxT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akIsR0FBUTdDLFFBRXZCakIsRUFBQXZCLFVBQUFzRyxPQUFSLFNBQWVqQixHQUNYLE1BQU85RCxHQUFJOEQsSUFBVzlELEVBQUksVUFUbENBLEVBQUE3QyxZQUFDaUIsT0FBQXVHLGNMNlNNM0UsS0s1U01WLFNBQUFVLElBQUdBIiwiZmlsZSI6ImxpYi9qcy1saWJyYXJ5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgY29yZV8xID0gcmVxdWlyZShcIkBhbmd1bGFyL2NvcmVcIik7XG52YXIgZGF0ZXBpY2tlcl9jb21wb25lbnRfMSA9IHJlcXVpcmUoJy4vZGF0ZXBpY2tlci5jb21wb25lbnQnKTtcbnZhciBEYXRlUGlja2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBEYXRlUGlja2VyKG1vZGFsQ3RybCkge1xuICAgICAgICB0aGlzLm1vZGFsQ3RybCA9IG1vZGFsQ3RybDtcbiAgICB9XG4gICAgRGF0ZVBpY2tlci5wcm90b3R5cGUub3Blbk1vZGFsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm1vZGFsQ3RybC5jcmVhdGUoZGF0ZXBpY2tlcl9jb21wb25lbnRfMS5EYXRlUGlja2VyQ29tcG9uZW50LCB7XG4gICAgICAgICAgICBkYXRlOiB0aGlzLmRhdGUsXG4gICAgICAgICAgICBtaW46IHRoaXMubWluLFxuICAgICAgICAgICAgbWF4OiB0aGlzLm1pbixcbiAgICAgICAgICAgIGNhbGxiYWNrOiB0aGlzLmNhbGxiYWNrXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGNvcmVfMS5JbnB1dCgnZGF0ZScpXG4gICAgXSwgRGF0ZVBpY2tlci5wcm90b3R5cGUsIFwiZGF0ZVwiKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgY29yZV8xLklucHV0KCdtaW4nKVxuICAgIF0sIERhdGVQaWNrZXIucHJvdG90eXBlLCBcIm1pblwiKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgY29yZV8xLklucHV0KCdtYXgnKVxuICAgIF0sIERhdGVQaWNrZXIucHJvdG90eXBlLCBcIm1heFwiKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgY29yZV8xLklucHV0KCdjYWxsYmFjaycpXG4gICAgXSwgRGF0ZVBpY2tlci5wcm90b3R5cGUsIFwiY2FsbGJhY2tcIik7XG4gICAgRGF0ZVBpY2tlciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBjb3JlXzEuRGlyZWN0aXZlKHtcbiAgICAgICAgICAgIHNlbGVjdG9yOiAnaW9uRGF0ZVBpY2tlcicsXG4gICAgICAgICAgICBob3N0OiB7XG4gICAgICAgICAgICAgICAgJyhjbGljayknOiAnb3Blbk1vZGFsKCknXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgXSwgRGF0ZVBpY2tlcik7XG4gICAgcmV0dXJuIERhdGVQaWNrZXI7XG59KCkpO1xuZXhwb3J0cy5EYXRlUGlja2VyID0gRGF0ZVBpY2tlcjtcblxuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgY29yZV8xID0gcmVxdWlyZSgnQGFuZ3VsYXIvY29yZScpO1xudmFyIHBsYXRmb3JtX2Jyb3dzZXJfMSA9IHJlcXVpcmUoJ0Bhbmd1bGFyL3BsYXRmb3JtLWJyb3dzZXInKTtcbnZhciBkYXRlcGlja2VyX2NvbXBvbmVudF8xID0gcmVxdWlyZSgnLi9kYXRlcGlja2VyLmNvbXBvbmVudCcpO1xudmFyIG5sc18xID0gcmVxdWlyZSgnLi9ubHMnKTtcbnZhciBkYXRlcGlja2VyX3NlcnZpY2VfMSA9IHJlcXVpcmUoJy4vZGF0ZXBpY2tlci5zZXJ2aWNlJyk7XG52YXIgYXBwX2NvbXBvbmVudF8xID0gcmVxdWlyZSgnLi9hcHAuY29tcG9uZW50Jyk7XG52YXIgQXBwTW9kdWxlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBBcHBNb2R1bGUoKSB7XG4gICAgfVxuICAgIEFwcE1vZHVsZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBjb3JlXzEuTmdNb2R1bGUoe1xuICAgICAgICAgICAgaW1wb3J0czogW3BsYXRmb3JtX2Jyb3dzZXJfMS5Ccm93c2VyTW9kdWxlXSxcbiAgICAgICAgICAgIGRlY2xhcmF0aW9uczogW2RhdGVwaWNrZXJfY29tcG9uZW50XzEuRGF0ZVBpY2tlckNvbXBvbmVudCwgbmxzXzEubmxzLCBkYXRlcGlja2VyX3NlcnZpY2VfMS5EYXRlU2VydmljZV0sXG4gICAgICAgICAgICBib290c3RyYXA6IFthcHBfY29tcG9uZW50XzEuRGF0ZVBpY2tlcl1cbiAgICAgICAgfSlcbiAgICBdLCBBcHBNb2R1bGUpO1xuICAgIHJldHVybiBBcHBNb2R1bGU7XG59KCkpO1xuZXhwb3J0cy5BcHBNb2R1bGUgPSBBcHBNb2R1bGU7XG5cblwidXNlIHN0cmljdFwiO1xudmFyIF9fZGVjb3JhdGUgPSAodGhpcyAmJiB0aGlzLl9fZGVjb3JhdGUpIHx8IGZ1bmN0aW9uIChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XG59O1xudmFyIGNvcmVfMSA9IHJlcXVpcmUoJ0Bhbmd1bGFyL2NvcmUnKTtcbnZhciBEYXRlUGlja2VyQ29tcG9uZW50ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBEYXRlUGlja2VyQ29tcG9uZW50KERhdGVwaWNrZXJTZXJ2aWNlLCBuYXZQYXJhbXMpIHtcbiAgICAgICAgdGhpcy5EYXRlcGlja2VyU2VydmljZSA9IERhdGVwaWNrZXJTZXJ2aWNlO1xuICAgICAgICB0aGlzLnR5cGUgPSAnZGF0ZSc7XG4gICAgICAgIHRoaXMudG9kYXkgPSBuZXcgRGF0ZSgpO1xuICAgICAgICB0aGlzLmRhdGUgPSBuYXZQYXJhbXMuZ2V0KFwiZGF0ZVwiKTtcbiAgICAgICAgdGhpcy5taW4gPSBuYXZQYXJhbXMuZ2V0KFwibWluXCIpO1xuICAgICAgICB0aGlzLm1heCA9IG5hdlBhcmFtcy5nZXQoXCJtYXhcIik7XG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBuYXZQYXJhbXMuZ2V0KFwiY2FsbGJhY2tcIik7XG4gICAgfVxuICAgIERhdGVQaWNrZXJDb21wb25lbnQucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWREYXRlID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5kYXRlIHx8IG5ldyBEYXRlKCkpO1xuICAgICAgICB0aGlzLnRlbXBEYXRlID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5zZWxlY3RlZERhdGUpO1xuICAgICAgICB0aGlzLmNyZWF0ZURhdGVMaXN0KHRoaXMuc2VsZWN0ZWREYXRlKTtcbiAgICB9O1xuICAgIERhdGVQaWNrZXJDb21wb25lbnQucHJvdG90eXBlLmdldERheXNPZldlZWsgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy53ZWVrZGF5cykge1xuICAgICAgICAgICAgdGhpcy53ZWVrZGF5cyA9IHRoaXMuRGF0ZXBpY2tlclNlcnZpY2UuZ2V0RGF5c09mV2VlaygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLndlZWtkYXlzO1xuICAgIH07XG4gICAgRGF0ZVBpY2tlckNvbXBvbmVudC5wcm90b3R5cGUuZ2V0TW9udGhzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMubW9udGhzKSB7XG4gICAgICAgICAgICB0aGlzLm1vbnRocyA9IHRoaXMuRGF0ZXBpY2tlclNlcnZpY2UuZ2V0TW9udGhzKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMubW9udGhzO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERhdGVQaWNrZXJDb21wb25lbnQucHJvdG90eXBlLCBcInllYXJzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5EYXRlcGlja2VyU2VydmljZS5nZXRZZWFycygpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBEYXRlUGlja2VyQ29tcG9uZW50LnByb3RvdHlwZS5jcmVhdGVEYXRlTGlzdCA9IGZ1bmN0aW9uIChzZWxlY3RlZERhdGUpIHtcbiAgICAgICAgdGhpcy5kYXRlTGlzdCA9IHRoaXMuRGF0ZXBpY2tlclNlcnZpY2UuY3JlYXRlRGF0ZUxpc3Qoc2VsZWN0ZWREYXRlKTtcbiAgICAgICAgdGhpcy5jb2xzID0gbmV3IEFycmF5KDcpO1xuICAgICAgICB0aGlzLnJvd3MgPSBuZXcgQXJyYXkoKyh0aGlzLmRhdGVMaXN0Lmxlbmd0aCAvIHRoaXMuY29scy5sZW5ndGgpICsgMSk7XG4gICAgfTtcbiAgICBEYXRlUGlja2VyQ29tcG9uZW50LnByb3RvdHlwZS5nZXREYXRlID0gZnVuY3Rpb24gKHJvdywgY29sKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGVMaXN0W3JvdyAqIDcgKyBjb2xdO1xuICAgIH07XG4gICAgRGF0ZVBpY2tlckNvbXBvbmVudC5wcm90b3R5cGUuaXNEZWZpbmVkID0gZnVuY3Rpb24gKGRhdGUpIHtcbiAgICAgICAgcmV0dXJuIGRhdGUgIT09IHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIERhdGVQaWNrZXJDb21wb25lbnQucHJvdG90eXBlLmlzRGlzYWJsZWQgPSBmdW5jdGlvbiAoZGF0ZSkge1xuICAgICAgICBpZiAoIWRhdGUpXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgaWYgKHRoaXMubWluKSB7XG4gICAgICAgICAgICB0aGlzLm1pbi5zZXRIb3VycygwLCAwLCAwLCAwKTtcbiAgICAgICAgICAgIGlmIChkYXRlIDwgdGhpcy5taW4pXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubWF4KSB7XG4gICAgICAgICAgICB0aGlzLm1heC5zZXRIb3VycygwLCAwLCAwLCAwKTtcbiAgICAgICAgICAgIGlmIChkYXRlID4gdGhpcy5tYXgpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgRGF0ZVBpY2tlckNvbXBvbmVudC5wcm90b3R5cGUuaXNBY3R1YWxEYXRlID0gZnVuY3Rpb24gKGRhdGUpIHtcbiAgICAgICAgaWYgKCFkYXRlKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gZGF0ZS5nZXREYXRlKCkgPT09IHRoaXMudG9kYXkuZ2V0RGF0ZSgpICYmXG4gICAgICAgICAgICBkYXRlLmdldE1vbnRoKCkgPT09IHRoaXMudG9kYXkuZ2V0TW9udGgoKSAmJlxuICAgICAgICAgICAgZGF0ZS5nZXRGdWxsWWVhcigpID09PSB0aGlzLnRvZGF5LmdldEZ1bGxZZWFyKCk7XG4gICAgfTtcbiAgICBEYXRlUGlja2VyQ29tcG9uZW50LnByb3RvdHlwZS5pc0FjdHVhbE1vbnRoID0gZnVuY3Rpb24gKG1vbnRoKSB7XG4gICAgICAgIHJldHVybiBtb250aCA9PT0gdGhpcy50b2RheS5nZXRNb250aCgpO1xuICAgIH07XG4gICAgRGF0ZVBpY2tlckNvbXBvbmVudC5wcm90b3R5cGUuaXNBY3R1YWxZZWFyID0gZnVuY3Rpb24gKHllYXIpIHtcbiAgICAgICAgcmV0dXJuIHllYXIgPT09IHRoaXMudG9kYXkuZ2V0RnVsbFllYXIoKTtcbiAgICB9O1xuICAgIERhdGVQaWNrZXJDb21wb25lbnQucHJvdG90eXBlLmlzU2VsZWN0ZWREYXRlID0gZnVuY3Rpb24gKGRhdGUpIHtcbiAgICAgICAgaWYgKCFkYXRlKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gZGF0ZS5nZXREYXRlKCkgPT09IHRoaXMuc2VsZWN0ZWREYXRlLmdldERhdGUoKSAmJlxuICAgICAgICAgICAgZGF0ZS5nZXRNb250aCgpID09PSB0aGlzLnNlbGVjdGVkRGF0ZS5nZXRNb250aCgpICYmXG4gICAgICAgICAgICBkYXRlLmdldEZ1bGxZZWFyKCkgPT09IHRoaXMuc2VsZWN0ZWREYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgfTtcbiAgICBEYXRlUGlja2VyQ29tcG9uZW50LnByb3RvdHlwZS5pc1NlbGVjdGVkTW9udGggPSBmdW5jdGlvbiAobW9udGgpIHtcbiAgICAgICAgcmV0dXJuIG1vbnRoID09PSB0aGlzLnRlbXBEYXRlLmdldE1vbnRoKCk7XG4gICAgfTtcbiAgICBEYXRlUGlja2VyQ29tcG9uZW50LnByb3RvdHlwZS5pc1NlbGVjdGVkWWVhciA9IGZ1bmN0aW9uICh5ZWFyKSB7XG4gICAgICAgIHJldHVybiB5ZWFyID09PSB0aGlzLnRlbXBEYXRlLmdldEZ1bGxZZWFyKCk7XG4gICAgfTtcbiAgICBEYXRlUGlja2VyQ29tcG9uZW50LnByb3RvdHlwZS5jaGFuZ2VUeXBlID0gZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICB0aGlzLnR5cGUgPSB2YWw7XG4gICAgfTtcbiAgICBEYXRlUGlja2VyQ29tcG9uZW50LnByb3RvdHlwZS5zaG93VHlwZSA9IGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudHlwZSA9PT0gdmFsO1xuICAgIH07XG4gICAgRGF0ZVBpY2tlckNvbXBvbmVudC5wcm90b3R5cGUuc2VsZWN0RGF0ZSA9IGZ1bmN0aW9uIChkYXRlKSB7XG4gICAgICAgIGlmICh0aGlzLmlzRGlzYWJsZWQoZGF0ZSkpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMuc2VsZWN0ZWREYXRlID0gT2JqZWN0LmFzc2lnbih7fSwgZGF0ZSk7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWREYXRlLnNldEhvdXJzKDAsIDAsIDAsIDApO1xuICAgICAgICB0aGlzLnRlbXBEYXRlID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5zZWxlY3RlZERhdGUpO1xuICAgIH07XG4gICAgRGF0ZVBpY2tlckNvbXBvbmVudC5wcm90b3R5cGUuc2VsZWN0TW9udGggPSBmdW5jdGlvbiAobW9udGgpIHtcbiAgICAgICAgdGhpcy50ZW1wRGF0ZSA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMudGVtcERhdGUpO1xuICAgICAgICB0aGlzLnRlbXBEYXRlLnNldE1vbnRoKG1vbnRoKTtcbiAgICAgICAgaWYgKHRoaXMudGVtcERhdGUuZ2V0TW9udGgoKSAhPT0gbW9udGgpIHtcbiAgICAgICAgICAgIHRoaXMudGVtcERhdGUuc2V0RGF0ZSgwKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNlbGVjdE1vbnRoT3JZZWFyKCk7XG4gICAgfTtcbiAgICBEYXRlUGlja2VyQ29tcG9uZW50LnByb3RvdHlwZS5zZWxlY3RZZWFyID0gZnVuY3Rpb24gKHllYXIpIHtcbiAgICAgICAgdGhpcy50ZW1wRGF0ZSA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMudGVtcERhdGUpO1xuICAgICAgICB0aGlzLnRlbXBEYXRlLnNldEZ1bGxZZWFyKHllYXIpO1xuICAgICAgICB0aGlzLnNlbGVjdE1vbnRoT3JZZWFyKCk7XG4gICAgfTtcbiAgICBEYXRlUGlja2VyQ29tcG9uZW50LnByb3RvdHlwZS5nZXRTZWxlY3RlZFdlZWtkYXkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy53ZWVrZGF5cylcbiAgICAgICAgICAgIHRoaXMuZ2V0RGF5c09mV2VlaygpO1xuICAgICAgICByZXR1cm4gdGhpcy53ZWVrZGF5c1t0aGlzLnNlbGVjdGVkRGF0ZS5nZXREYXkoKV07XG4gICAgfTtcbiAgICBEYXRlUGlja2VyQ29tcG9uZW50LnByb3RvdHlwZS5nZXRTZWxlY3RlZE1vbnRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMubW9udGhzKVxuICAgICAgICAgICAgdGhpcy5nZXRNb250aHMoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubW9udGhzW3RoaXMuc2VsZWN0ZWREYXRlLmdldE1vbnRoKCldO1xuICAgIH07XG4gICAgRGF0ZVBpY2tlckNvbXBvbmVudC5wcm90b3R5cGUuZ2V0VGVtcE1vbnRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMubW9udGhzKVxuICAgICAgICAgICAgdGhpcy5nZXRNb250aHMoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubW9udGhzW3RoaXMudGVtcERhdGUuZ2V0TW9udGgoKV07XG4gICAgfTtcbiAgICBEYXRlUGlja2VyQ29tcG9uZW50LnByb3RvdHlwZS5vbkNhbmNlbCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWREYXRlID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5kYXRlIHx8IG5ldyBEYXRlKCkpO1xuICAgICAgICB0aGlzLmNhbGxiYWNrKHVuZGVmaW5lZCk7XG4gICAgfTtcbiAgICA7XG4gICAgRGF0ZVBpY2tlckNvbXBvbmVudC5wcm90b3R5cGUub25Eb25lID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdGhpcy5kYXRlID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5zZWxlY3RlZERhdGUpO1xuICAgICAgICB0aGlzLmNhbGxiYWNrKHRoaXMuZGF0ZSk7XG4gICAgfTtcbiAgICA7XG4gICAgRGF0ZVBpY2tlckNvbXBvbmVudC5wcm90b3R5cGUuc2VsZWN0TW9udGhPclllYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlVHlwZSgnZGF0ZScpO1xuICAgICAgICB0aGlzLmNyZWF0ZURhdGVMaXN0KHRoaXMudGVtcERhdGUpO1xuICAgICAgICBpZiAodGhpcy5pc0Rpc2FibGVkKHRoaXMudGVtcERhdGUpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLnNlbGVjdGVkRGF0ZSA9IHRoaXMudGVtcERhdGU7XG4gICAgfTtcbiAgICBEYXRlUGlja2VyQ29tcG9uZW50ID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGNvcmVfMS5Db21wb25lbnQoe1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgICAgIHNlbGVjdG9yOiAnaW9uRGF0ZXBpY2tlcidcbiAgICAgICAgfSlcbiAgICBdLCBEYXRlUGlja2VyQ29tcG9uZW50KTtcbiAgICByZXR1cm4gRGF0ZVBpY2tlckNvbXBvbmVudDtcbn0oKSk7XG5leHBvcnRzLkRhdGVQaWNrZXJDb21wb25lbnQgPSBEYXRlUGlja2VyQ29tcG9uZW50O1xuXG5cInVzZSBzdHJpY3RcIjtcbnZhciBfX2RlY29yYXRlID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xufTtcbnZhciBjb3JlXzEgPSByZXF1aXJlKCdAYW5ndWxhci9jb3JlJyk7XG4vKipcbiAqIERhdGVTZXJ2aWNlXG4gKi9cbnZhciBEYXRlU2VydmljZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRGF0ZVNlcnZpY2UoRGF0ZXBpY2tlck5scykge1xuICAgICAgICB0aGlzLkRhdGVwaWNrZXJObHMgPSBEYXRlcGlja2VyTmxzO1xuICAgICAgICB0aGlzLmxvY2FsZSA9ICh3aW5kb3cubmF2aWdhdG9yWyd1c2VyTGFuZ3VhZ2UnXSB8fCB3aW5kb3cubmF2aWdhdG9yLmxhbmd1YWdlKS50b0xvd2VyQ2FzZSgpO1xuICAgIH1cbiAgICBEYXRlU2VydmljZS5wcm90b3R5cGUuZ2V0RGF5c09mV2VlayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuRGF0ZXBpY2tlck5scy5nZXRXZWVrZGF5cyh0aGlzLmxvY2FsZSk7XG4gICAgfTtcbiAgICBEYXRlU2VydmljZS5wcm90b3R5cGUuZ2V0TW9udGhzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5EYXRlcGlja2VyTmxzLmdldE1vbnRocyh0aGlzLmxvY2FsZSk7XG4gICAgfTtcbiAgICBEYXRlU2VydmljZS5wcm90b3R5cGUuZ2V0WWVhcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB5ZWFycyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMTkwMDsgaSA8IDIxMDE7IGkrKylcbiAgICAgICAgICAgIHllYXJzLnB1c2goaSk7XG4gICAgICAgIHJldHVybiB5ZWFycztcbiAgICB9O1xuICAgIERhdGVTZXJ2aWNlLnByb3RvdHlwZS5jcmVhdGVEYXRlTGlzdCA9IGZ1bmN0aW9uIChjdXJyZW50RGF0ZSkge1xuICAgICAgICB2YXIgZmlyc3REYXkgPSBuZXcgRGF0ZShjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpLCBjdXJyZW50RGF0ZS5nZXRNb250aCgpLCAxKS5nZXREYXRlKCk7XG4gICAgICAgIHZhciBsYXN0RGF5ID0gbmV3IERhdGUoY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKSwgY3VycmVudERhdGUuZ2V0TW9udGgoKSArIDEsIDApLmdldERhdGUoKTtcbiAgICAgICAgdmFyIGRhdGVMaXN0ID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSBmaXJzdERheTsgaSA8PSBsYXN0RGF5OyBpKyspIHtcbiAgICAgICAgICAgIGRhdGVMaXN0LnB1c2gobmV3IERhdGUoY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKSwgY3VycmVudERhdGUuZ2V0TW9udGgoKSwgaSkpO1xuICAgICAgICB9XG4gICAgICAgIGZpcnN0RGF5ID0gZGF0ZUxpc3RbMF0uZ2V0RGF5KCk7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZmlyc3REYXk7IGorKykge1xuICAgICAgICAgICAgZGF0ZUxpc3QudW5zaGlmdCh1bmRlZmluZWQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRlTGlzdDtcbiAgICB9O1xuICAgIERhdGVTZXJ2aWNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGNvcmVfMS5JbmplY3RhYmxlKClcbiAgICBdLCBEYXRlU2VydmljZSk7XG4gICAgcmV0dXJuIERhdGVTZXJ2aWNlO1xufSgpKTtcbmV4cG9ydHMuRGF0ZVNlcnZpY2UgPSBEYXRlU2VydmljZTtcblxuXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgY29yZV8xID0gcmVxdWlyZSgnQGFuZ3VsYXIvY29yZScpO1xudmFyIF9ubHMgPSB7XG4gICAgJ2VuLXVzJzoge1xuICAgICAgICB3ZWVrZGF5czogWydTdW5kYXknLCAnTW9uZGF5JywgJ1R1ZXNkYXknLCAnV2VkbmVzZGF5JywgJ1RodXJzZGF5JywgJ0ZyaWRheScsICdTYXR1cmRheSddLFxuICAgICAgICBtb250aHM6IFsnSmFudWFyeScsICdGZWJydWFyeScsICdNYXJjaCcsICdBcHJpbCcsICdNYXknLCAnSnVuZScsICdKdWx5JywgJ0F1Z3VzdCcsICdTZXB0ZW1iZXInLCAnT2N0b2JlcicsICdOb3ZlbWJlcicsICdEZWNlbWJlciddXG4gICAgfSxcbiAgICAncHQtYnInOiB7XG4gICAgICAgIHdlZWtkYXlzOiBbJ0RvbWluZ28nLCAnU2VndW5kYS1GZWlyYScsICdUZXLDp2EtRmVpcmEnLCAnUXVhcnRhLUZlaXJhJywgJ1F1aW50YS1GZWlyYScsICdTZXh0YS1GZWlyYScsICdTw6FiYWRvJ10sXG4gICAgICAgIG1vbnRoczogWydKYW5laXJvJywgJ0ZldmVyZWlybycsICdNYXLDp28nLCAnQWJyaWwnLCAnTWFpbycsICdKdW5obycsICdKdWxobycsICdBZ29zdG8nLCAnU2V0ZW1icm8nLCAnT3V0dWJybycsICdOb3ZlbWJybycsICdEZXplbWJybyddXG4gICAgfVxufTtcbnZhciBubHMgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIG5scygpIHtcbiAgICB9XG4gICAgbmxzLnByb3RvdHlwZS5nZXRXZWVrZGF5cyA9IGZ1bmN0aW9uIChsb2NhbGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TmxzKGxvY2FsZSkud2Vla2RheXM7XG4gICAgfTtcbiAgICBubHMucHJvdG90eXBlLmdldE1vbnRocyA9IGZ1bmN0aW9uIChsb2NhbGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0TmxzKGxvY2FsZSkubW9udGhzO1xuICAgIH07XG4gICAgbmxzLnByb3RvdHlwZS5nZXRObHMgPSBmdW5jdGlvbiAobG9jYWxlKSB7XG4gICAgICAgIHJldHVybiBubHNbbG9jYWxlXSB8fCBubHNbJ2VuLXVzJ107XG4gICAgfTtcbiAgICBubHMgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgY29yZV8xLkluamVjdGFibGUoKVxuICAgIF0sIG5scyk7XG4gICAgcmV0dXJuIG5scztcbn0oKSk7XG5leHBvcnRzLm5scyA9IG5scztcbiIsImltcG9ydCB7IERpcmVjdGl2ZSwgSW5wdXQgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xyXG5pbXBvcnQgeyAgTW9kYWxDb250cm9sbGVyIH0gZnJvbSBcImlvbmljLWFuZ3VsYXJcIjtcclxuaW1wb3J0IHsgRGF0ZVBpY2tlckNvbXBvbmVudCB9IGZyb20gJy4vZGF0ZXBpY2tlci5jb21wb25lbnQnO1xyXG5ARGlyZWN0aXZlKHtcclxuICAgIHNlbGVjdG9yOiAnaW9uRGF0ZVBpY2tlcicsXHJcbiAgICBob3N0OiB7XHJcbiAgICAgICAgJyhjbGljayknOiAnb3Blbk1vZGFsKCknLFxyXG5cclxuICAgIH1cclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyBEYXRlUGlja2VyIHtcclxuICAgIEBJbnB1dCgnZGF0ZScpIHByaXZhdGUgZGF0ZTogRGF0ZTtcclxuICAgIEBJbnB1dCgnbWluJykgcHJpdmF0ZSBtaW46IERhdGU7XHJcbiAgICBASW5wdXQoJ21heCcpIHByaXZhdGUgbWF4OiBEYXRlO1xyXG4gICAgQElucHV0KCdjYWxsYmFjaycpIHByaXZhdGUgY2FsbGJhY2s6IChkYXRlOiBEYXRlIHwgdW5kZWZpbmVkKSA9PiB7fTtcclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgbW9kYWxDdHJsOiBNb2RhbENvbnRyb2xsZXIpIHtcclxuICAgIH1cclxuICAgIG9wZW5Nb2RhbCgpIHtcclxuICAgICAgICB0aGlzLm1vZGFsQ3RybC5jcmVhdGUoRGF0ZVBpY2tlckNvbXBvbmVudCxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGRhdGU6dGhpcy5kYXRlLFxyXG4gICAgICAgICAgICBtaW46dGhpcy5taW4sXHJcbiAgICAgICAgICAgIG1heDp0aGlzLm1pbixcclxuICAgICAgICAgICAgY2FsbGJhY2s6dGhpcy5jYWxsYmFja1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHtcclxuICAgIE5nTW9kdWxlXHJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7XHJcbiAgICBCcm93c2VyTW9kdWxlXHJcbn0gZnJvbSAnQGFuZ3VsYXIvcGxhdGZvcm0tYnJvd3Nlcic7XHJcbmltcG9ydCB7XHJcbiAgICBEYXRlUGlja2VyQ29tcG9uZW50XHJcbn0gZnJvbSAnLi9kYXRlcGlja2VyLmNvbXBvbmVudCc7XHJcbmltcG9ydCB7XHJcbiAgICBubHNcclxufSBmcm9tICcuL25scyc7XHJcbmltcG9ydCB7XHJcbiAgICBEYXRlU2VydmljZVxyXG59IGZyb20gJy4vZGF0ZXBpY2tlci5zZXJ2aWNlJztcclxuaW1wb3J0IHtcclxuICAgIERhdGVQaWNrZXJcclxufSBmcm9tICcuL2FwcC5jb21wb25lbnQnO1xyXG5ATmdNb2R1bGUoe1xyXG4gICAgaW1wb3J0czogW0Jyb3dzZXJNb2R1bGVdLFxyXG4gICAgZGVjbGFyYXRpb25zOiBbRGF0ZVBpY2tlckNvbXBvbmVudCwgbmxzLCBEYXRlU2VydmljZV0sXHJcbiAgICBib290c3RyYXA6IFtEYXRlUGlja2VyXVxyXG59KVxyXG5leHBvcnQgY2xhc3MgQXBwTW9kdWxlIHsgfSIsImltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIE91dHB1dCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBEYXRlU2VydmljZSB9IGZyb20gJy4vZGF0ZXBpY2tlci5zZXJ2aWNlJztcclxuaW1wb3J0IHsgTmF2UGFyYW1zLCBWaWV3Q29udHJvbGxlciB9IGZyb20gXCJpb25pYy1hbmd1bGFyXCI7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGUuaHRtbCcsXHJcbiAgICBzZWxlY3RvcjogJ2lvbkRhdGVwaWNrZXInLFxyXG5cclxufSlcclxuXHJcbmV4cG9ydCBjbGFzcyBEYXRlUGlja2VyQ29tcG9uZW50IHtcclxuICAgIHByaXZhdGUgdHlwZTogJ2RhdGUnIHwgJ3N0cmluZycgPSAnZGF0ZSc7XHJcbiAgICBwcml2YXRlIHRvZGF5OiBEYXRlID0gbmV3IERhdGUoKTtcclxuICAgIHByaXZhdGUgc2VsZWN0ZWREYXRlOiBEYXRlO1xyXG4gICAgcHJpdmF0ZSB0ZW1wRGF0ZTogRGF0ZTtcclxuICAgIHByaXZhdGUgZGF0ZUxpc3Q6IERhdGVbXTtcclxuICAgIHByaXZhdGUgY29sczogbnVtYmVyW107XHJcbiAgICBwcml2YXRlIHJvd3M6IG51bWJlcltdO1xyXG4gICAgcHJpdmF0ZSB3ZWVrZGF5czogc3RyaW5nW107XHJcbiAgICBwcml2YXRlIG1vbnRoczogc3RyaW5nW107XHJcbiAgICBwcml2YXRlIGRhdGU6IERhdGU7XHJcbiAgICBwcml2YXRlIG1pbjogRGF0ZTtcclxuICAgIHByaXZhdGUgbWF4OiBEYXRlO1xyXG4gICAgcHJpdmF0ZSBjYWxsYmFjazogKGRhdGU6IERhdGUgfCB1bmRlZmluZWQpID0+IHt9O1xyXG4gICAgY29uc3RydWN0b3IocHVibGljIERhdGVwaWNrZXJTZXJ2aWNlOiBEYXRlU2VydmljZSwgbmF2UGFyYW1zOiBOYXZQYXJhbXMpIHtcclxuICAgICAgICB0aGlzLmRhdGUgPSBuYXZQYXJhbXMuZ2V0KFwiZGF0ZVwiKTtcclxuICAgICAgICB0aGlzLm1pbiA9IG5hdlBhcmFtcy5nZXQoXCJtaW5cIik7XHJcbiAgICAgICAgdGhpcy5tYXggPSBuYXZQYXJhbXMuZ2V0KFwibWF4XCIpO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBuYXZQYXJhbXMuZ2V0KFwiY2FsbGJhY2tcIik7XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgaW5pdGlhbGl6ZSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkRGF0ZSA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMuZGF0ZSB8fCBuZXcgRGF0ZSgpKTtcclxuICAgICAgICB0aGlzLnRlbXBEYXRlID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5zZWxlY3RlZERhdGUpO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlRGF0ZUxpc3QodGhpcy5zZWxlY3RlZERhdGUpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXREYXlzT2ZXZWVrKCk6IHN0cmluZ1tdIHtcclxuICAgICAgICBpZiAoIXRoaXMud2Vla2RheXMpIHtcclxuICAgICAgICAgICAgdGhpcy53ZWVrZGF5cyA9IHRoaXMuRGF0ZXBpY2tlclNlcnZpY2UuZ2V0RGF5c09mV2VlaygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy53ZWVrZGF5cztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0TW9udGhzKCk6IHN0cmluZ1tdIHtcclxuICAgICAgICBpZiAoIXRoaXMubW9udGhzKSB7XHJcbiAgICAgICAgICAgIHRoaXMubW9udGhzID0gdGhpcy5EYXRlcGlja2VyU2VydmljZS5nZXRNb250aHMoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubW9udGhzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXQgeWVhcnMoKTogRGF0ZVtdIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5EYXRlcGlja2VyU2VydmljZS5nZXRZZWFycygpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjcmVhdGVEYXRlTGlzdChzZWxlY3RlZERhdGU6IERhdGUpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmRhdGVMaXN0ID0gdGhpcy5EYXRlcGlja2VyU2VydmljZS5jcmVhdGVEYXRlTGlzdChzZWxlY3RlZERhdGUpO1xyXG4gICAgICAgIHRoaXMuY29scyA9IG5ldyBBcnJheSg3KTtcclxuICAgICAgICB0aGlzLnJvd3MgPSBuZXcgQXJyYXkoKyh0aGlzLmRhdGVMaXN0Lmxlbmd0aCAvIHRoaXMuY29scy5sZW5ndGgpICsgMSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldERhdGUocm93OiBudW1iZXIsIGNvbDogbnVtYmVyKTogRGF0ZSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0ZUxpc3Rbcm93ICogNyArIGNvbF07XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGlzRGVmaW5lZChkYXRlOiBEYXRlIHwgc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIGRhdGUgIT09IHVuZGVmaW5lZDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaXNEaXNhYmxlZChkYXRlOiBEYXRlKTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKCFkYXRlKSByZXR1cm4gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy5taW4pIHtcclxuICAgICAgICAgICAgdGhpcy5taW4uc2V0SG91cnMoMCwgMCwgMCwgMCk7XHJcbiAgICAgICAgICAgIGlmIChkYXRlIDwgdGhpcy5taW4pIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5tYXgpIHtcclxuICAgICAgICAgICAgdGhpcy5tYXguc2V0SG91cnMoMCwgMCwgMCwgMCk7XHJcbiAgICAgICAgICAgIGlmIChkYXRlID4gdGhpcy5tYXgpIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGlzQWN0dWFsRGF0ZShkYXRlOiBEYXRlKTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKCFkYXRlKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIGRhdGUuZ2V0RGF0ZSgpID09PSB0aGlzLnRvZGF5LmdldERhdGUoKSAmJlxyXG4gICAgICAgICAgICBkYXRlLmdldE1vbnRoKCkgPT09IHRoaXMudG9kYXkuZ2V0TW9udGgoKSAmJlxyXG4gICAgICAgICAgICBkYXRlLmdldEZ1bGxZZWFyKCkgPT09IHRoaXMudG9kYXkuZ2V0RnVsbFllYXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaXNBY3R1YWxNb250aChtb250aDogbnVtYmVyKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIG1vbnRoID09PSB0aGlzLnRvZGF5LmdldE1vbnRoKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGlzQWN0dWFsWWVhcih5ZWFyOiBudW1iZXIpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4geWVhciA9PT0gdGhpcy50b2RheS5nZXRGdWxsWWVhcigpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBpc1NlbGVjdGVkRGF0ZShkYXRlOiBEYXRlKTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKCFkYXRlKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIGRhdGUuZ2V0RGF0ZSgpID09PSB0aGlzLnNlbGVjdGVkRGF0ZS5nZXREYXRlKCkgJiZcclxuICAgICAgICAgICAgZGF0ZS5nZXRNb250aCgpID09PSB0aGlzLnNlbGVjdGVkRGF0ZS5nZXRNb250aCgpICYmXHJcbiAgICAgICAgICAgIGRhdGUuZ2V0RnVsbFllYXIoKSA9PT0gdGhpcy5zZWxlY3RlZERhdGUuZ2V0RnVsbFllYXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaXNTZWxlY3RlZE1vbnRoKG1vbnRoOiBudW1iZXIpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gbW9udGggPT09IHRoaXMudGVtcERhdGUuZ2V0TW9udGgoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaXNTZWxlY3RlZFllYXIoeWVhcjogbnVtYmVyKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHllYXIgPT09IHRoaXMudGVtcERhdGUuZ2V0RnVsbFllYXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2hhbmdlVHlwZSh2YWw6ICdkYXRlJyB8ICdzdHJpbmcnKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy50eXBlID0gdmFsO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzaG93VHlwZSh2YWw6ICdkYXRlJyB8ICdzdHJpbmcnKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudHlwZSA9PT0gdmFsO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZWxlY3REYXRlKGRhdGU6IERhdGUpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5pc0Rpc2FibGVkKGRhdGUpKSByZXR1cm47XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZERhdGUgPSBPYmplY3QuYXNzaWduKHt9LCBkYXRlKTtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkRGF0ZS5zZXRIb3VycygwLCAwLCAwLCAwKTtcclxuICAgICAgICB0aGlzLnRlbXBEYXRlID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5zZWxlY3RlZERhdGUpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZWxlY3RNb250aChtb250aDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy50ZW1wRGF0ZSA9IE9iamVjdC5hc3NpZ24oe30sIHRoaXMudGVtcERhdGUpO1xyXG4gICAgICAgIHRoaXMudGVtcERhdGUuc2V0TW9udGgobW9udGgpO1xyXG4gICAgICAgIGlmICh0aGlzLnRlbXBEYXRlLmdldE1vbnRoKCkgIT09IG1vbnRoKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGVtcERhdGUuc2V0RGF0ZSgwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zZWxlY3RNb250aE9yWWVhcigpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZWxlY3RZZWFyKHllYXIpIHtcclxuICAgICAgICB0aGlzLnRlbXBEYXRlID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy50ZW1wRGF0ZSk7XHJcbiAgICAgICAgdGhpcy50ZW1wRGF0ZS5zZXRGdWxsWWVhcih5ZWFyKTtcclxuICAgICAgICB0aGlzLnNlbGVjdE1vbnRoT3JZZWFyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFNlbGVjdGVkV2Vla2RheSgpOiBzdHJpbmcge1xyXG4gICAgICAgIGlmICghdGhpcy53ZWVrZGF5cykgdGhpcy5nZXREYXlzT2ZXZWVrKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMud2Vla2RheXNbdGhpcy5zZWxlY3RlZERhdGUuZ2V0RGF5KCldO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRTZWxlY3RlZE1vbnRoKCk6IHN0cmluZyB7XHJcbiAgICAgICAgaWYgKCF0aGlzLm1vbnRocykgdGhpcy5nZXRNb250aHMoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5tb250aHNbdGhpcy5zZWxlY3RlZERhdGUuZ2V0TW9udGgoKV07XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFRlbXBNb250aCgpIHtcclxuICAgICAgICBpZiAoIXRoaXMubW9udGhzKSB0aGlzLmdldE1vbnRocygpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLm1vbnRoc1t0aGlzLnRlbXBEYXRlLmdldE1vbnRoKCldO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvbkNhbmNlbChlKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZERhdGUgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmRhdGUgfHwgbmV3IERhdGUoKSk7XHJcbiAgICAgICAgdGhpcy5jYWxsYmFjayh1bmRlZmluZWQpO1xyXG4gICAgfTtcclxuXHJcbiAgICBwdWJsaWMgb25Eb25lKGUpIHtcclxuICAgICAgICB0aGlzLmRhdGUgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLnNlbGVjdGVkRGF0ZSk7XHJcbiAgICAgICAgdGhpcy5jYWxsYmFjayh0aGlzLmRhdGUpO1xyXG4gICAgfTtcclxuXHJcbiAgICBwcml2YXRlIHNlbGVjdE1vbnRoT3JZZWFyKCkge1xyXG4gICAgICAgIHRoaXMuY2hhbmdlVHlwZSgnZGF0ZScpO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlRGF0ZUxpc3QodGhpcy50ZW1wRGF0ZSk7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNEaXNhYmxlZCh0aGlzLnRlbXBEYXRlKSkgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWREYXRlID0gdGhpcy50ZW1wRGF0ZTtcclxuICAgIH1cclxufSIsImltcG9ydCB7IG5scyB9IGZyb20gJy4vbmxzJztcclxuaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5cclxuLyoqXHJcbiAqIERhdGVTZXJ2aWNlXHJcbiAqL1xyXG5ASW5qZWN0YWJsZSgpXHJcbmV4cG9ydCBjbGFzcyBEYXRlU2VydmljZSB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIERhdGVwaWNrZXJObHM6IG5scykge1xyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBsb2NhbGUgPSAod2luZG93Lm5hdmlnYXRvclsndXNlckxhbmd1YWdlJ10gfHwgd2luZG93Lm5hdmlnYXRvci5sYW5ndWFnZSkudG9Mb3dlckNhc2UoKTtcclxuXHJcbiAgICBwdWJsaWMgZ2V0RGF5c09mV2VlaygpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5EYXRlcGlja2VyTmxzLmdldFdlZWtkYXlzKHRoaXMubG9jYWxlKTtcclxuICAgIH1cclxuICAgIHB1YmxpYyBnZXRNb250aHMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuRGF0ZXBpY2tlck5scy5nZXRNb250aHModGhpcy5sb2NhbGUpO1xyXG4gICAgfVxyXG4gICAgcHVibGljIGdldFllYXJzKCkge1xyXG4gICAgICAgIGxldCB5ZWFycyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAxOTAwOyBpIDwgMjEwMTsgaSsrKSB5ZWFycy5wdXNoKGkpO1xyXG4gICAgICAgIHJldHVybiB5ZWFycztcclxuICAgIH1cclxuICAgIHB1YmxpYyBjcmVhdGVEYXRlTGlzdChjdXJyZW50RGF0ZTogRGF0ZSkge1xyXG4gICAgICAgIGxldCBmaXJzdERheSA9IG5ldyBEYXRlKGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCksIGN1cnJlbnREYXRlLmdldE1vbnRoKCksIDEpLmdldERhdGUoKTtcclxuICAgICAgICBsZXQgbGFzdERheSA9IG5ldyBEYXRlKGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCksIGN1cnJlbnREYXRlLmdldE1vbnRoKCkgKyAxLCAwKS5nZXREYXRlKClcclxuICAgICAgICBsZXQgZGF0ZUxpc3Q6IERhdGVbXSA9IFtdO1xyXG5cclxuICAgICAgICBmb3IgKHZhciBpID0gZmlyc3REYXk7IGkgPD0gbGFzdERheTsgaSsrKSB7XHJcbiAgICAgICAgICAgIGRhdGVMaXN0LnB1c2gobmV3IERhdGUoY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKSwgY3VycmVudERhdGUuZ2V0TW9udGgoKSwgaSkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZmlyc3REYXkgPSBkYXRlTGlzdFswXS5nZXREYXkoKTtcclxuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGZpcnN0RGF5OyBqKyspIHtcclxuICAgICAgICAgICAgZGF0ZUxpc3QudW5zaGlmdCh1bmRlZmluZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZGF0ZUxpc3Q7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5jb25zdCBfbmxzID1cclxuICAgIHtcclxuICAgICAgICAnZW4tdXMnOiB7XHJcbiAgICAgICAgICAgIHdlZWtkYXlzOiBbJ1N1bmRheScsICdNb25kYXknLCAnVHVlc2RheScsICdXZWRuZXNkYXknLCAnVGh1cnNkYXknLCAnRnJpZGF5JywgJ1NhdHVyZGF5J10sXHJcbiAgICAgICAgICAgIG1vbnRoczogWydKYW51YXJ5JywgJ0ZlYnJ1YXJ5JywgJ01hcmNoJywgJ0FwcmlsJywgJ01heScsICdKdW5lJywgJ0p1bHknLCAnQXVndXN0JywgJ1NlcHRlbWJlcicsICdPY3RvYmVyJywgJ05vdmVtYmVyJywgJ0RlY2VtYmVyJ11cclxuICAgICAgICB9LFxyXG4gICAgICAgICdwdC1icic6IHtcclxuICAgICAgICAgICAgd2Vla2RheXM6IFsnRG9taW5nbycsICdTZWd1bmRhLUZlaXJhJywgJ1RlcsOnYS1GZWlyYScsICdRdWFydGEtRmVpcmEnLCAnUXVpbnRhLUZlaXJhJywgJ1NleHRhLUZlaXJhJywgJ1PDoWJhZG8nXSxcclxuICAgICAgICAgICAgbW9udGhzOiBbJ0phbmVpcm8nLCAnRmV2ZXJlaXJvJywgJ01hcsOnbycsICdBYnJpbCcsICdNYWlvJywgJ0p1bmhvJywgJ0p1bGhvJywgJ0Fnb3N0bycsICdTZXRlbWJybycsICdPdXR1YnJvJywgJ05vdmVtYnJvJywgJ0RlemVtYnJvJ11cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuQEluamVjdGFibGUoKVxyXG5leHBvcnQgY2xhc3MgbmxzIHtcclxuICAgIHB1YmxpYyBnZXRXZWVrZGF5cyhsb2NhbGU6ICdlbi11cycgfCAncHQtYnInKTogc3RyaW5nW10ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldE5scyhsb2NhbGUpLndlZWtkYXlzO1xyXG4gICAgfVxyXG4gICAgcHVibGljIGdldE1vbnRocyhsb2NhbGU6ICdlbi11cycgfCAncHQtYnInKTogc3RyaW5nW10ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldE5scyhsb2NhbGUpLm1vbnRocztcclxuICAgIH1cclxuICAgIHByaXZhdGUgZ2V0TmxzKGxvY2FsZTogJ2VuLXVzJyB8ICdwdC1icicpOiB7IHdlZWtkYXlzOiBzdHJpbmdbXSwgbW9udGhzOiBzdHJpbmdbXSB9IHtcclxuICAgICAgICByZXR1cm4gbmxzW2xvY2FsZV0gfHwgbmxzWydlbi11cyddO1xyXG4gICAgfVxyXG59XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
